# Supreme Infrastructure Generator

ะกัะฟะตั-ะณะตะฝะตัะฐัะพั, ะบะพัะพััะน ะทะฐะฟััะบะฐะตั ะฒัะต ะณะตะฝะตัะฐัะพัั ะธะฝััะฐััััะบัััั ะฒ ะฟัะฐะฒะธะปัะฝะพะผ ะฟะพััะดะบะต.

## ะะฟะธัะฐะฝะธะต

ะญัะพั ะณะตะฝะตัะฐัะพั ะพะฑัะตะดะธะฝัะตั ััะฝะบัะธะพะฝะฐะปัะฝะพััั ะฒัะตั ะณะตะฝะตัะฐัะพัะพะฒ ะธะฝััะฐััััะบัััั:
1. **Security Checks** - ะพะฑะฝะพะฒะปะตะฝะธะต GitHub Actions workflow ะดะปั security ะฟัะพะฒะตัะพะบ
2. **CD Workflow** - ะพะฑะฝะพะฒะปะตะฝะธะต GitHub Actions workflow ะดะปั continuous deployment
3. **Values Files** - ะณะตะฝะตัะฐัะธั Helm values ัะฐะนะปะพะฒ ะดะปั ะฒัะตั ะพะบััะถะตะฝะธะน

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

```bash
pnpm run generate
```

## ะงัะพ ะดะตะปะฐะตั ะณะตะฝะตัะฐัะพั

### Step 1: Updating security checks
- ะงะธัะฐะตั ัะฟะธัะพะบ ัะตัะฒะธัะพะฒ ะธะท `infra/services.yaml`
- ะะฑะฝะพะฒะปัะตั `.github/workflows/security-checks.yml`
- ะะพะฑะฐะฒะปัะตั ะฒัะต NestJS ัะตัะฒะธัั ะฒ matrix ะดะปั security-scan-nest
- ะะพะฑะฐะฒะปัะตั ะฒัะต Next.js ัะตัะฒะธัั ะฒ matrix ะดะปั security-scan-next

### Step 2: Updating CD workflow
- ะงะธัะฐะตั ัะฟะธัะพะบ ัะตัะฒะธัะพะฒ ะธะท `infra/services.yaml`
- ะะฑะฝะพะฒะปัะตั `.github/workflows/cd.yml`
- ะะพะฑะฐะฒะปัะตั ะฒัะต ัะตัะฒะธัั ะฒ ัะฟะธัะพะบ options ะดะปั manual deployment
- ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟะตัะฒัะน ัะตัะฒะธั ะบะฐะบ default

### Step 3: Generating values files
- ะงะธัะฐะตั ัะฟะธัะพะบ ัะตัะฒะธัะพะฒ ะธะท `infra/services.yaml`
- ะะปั ะบะฐะถะดะพะณะพ ัะตัะฒะธัะฐ ะณะตะฝะตัะธััะตั ะฟะพะปะฝัะต Helm values ัะฐะนะปั
- ะกะพะทะดะฐะตั ัะฐะนะปั ะดะปั ะฒัะตั ะพะบััะถะตะฝะธะน (development, staging, production)
- ะัะธะผะตะฝัะตั ะฝะฐัััะพะนะบะธ ัะธะฟะฐ ัะตัะฒะธัะฐ, environment overrides ะธ service-specific overrides
- ะกะพััะฐะฝัะตั ัะตะทัะปััะฐัั ะฒ `infra/overrides/${environment}/${service_name}.yaml`

## ะัะฒะพะด ะณะตะฝะตัะฐัะพัะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Supreme Infrastructure Generator
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ Step 1/3: Updating security checks...
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Security checks updated successfully!
  Nest services: backend
  Next services: frontend

๐ Step 2/3: Updating CD workflow...
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ CD workflow updated successfully!
  Services: backend, frontend
  Default service: backend

๐ Step 3/3: Generating values files...
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Starting values generation process
โ Found 2 service(s) to process:
โ   โข backend (nest) - Backend service (NestJS)
โ   โข frontend (next) - Frontend service (Next.js)

[... ะฟะพะดัะพะฑะฝัะต ะปะพะณะธ ะณะตะฝะตัะฐัะธะธ ...]

โ Generation summary:
โ   Total files generated: 6

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ All generation tasks completed successfully!
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะพะฝัะธะณััะฐัะธั

ะัะต ะณะตะฝะตัะฐัะพัั ะธัะฟะพะปัะทััั ะตะดะธะฝัะน ัะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ `infra/services.yaml`:

```yaml
services:
  - name: backend
    type: nest
    description: Backend service (NestJS)
  
  - name: frontend
    type: next
    description: Frontend service (Next.js)
```

## ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะตัะฒะธัะฐ

1. ะะพะฑะฐะฒััะต ัะตัะฒะธั ะฒ `infra/services.yaml`:
```yaml
services:
  - name: my-new-service
    type: nest  # ะธะปะธ next
    description: My new service description
```

2. ะกะพะทะดะฐะนัะต `services/my-new-service/service.yaml` ั ะฝะฐัััะพะนะบะฐะผะธ

3. ะะฐะฟัััะธัะต ะณะตะฝะตัะฐัะพั:
```bash
pnpm run generate
```

ะะตะฝะตัะฐัะพั ะฐะฒัะพะผะฐัะธัะตัะบะธ:
- ะะพะฑะฐะฒะธั ัะตัะฒะธั ะฒ security checks workflow
- ะะพะฑะฐะฒะธั ัะตัะฒะธั ะฒ CD workflow
- ะกะณะตะฝะตัะธััะตั values ัะฐะนะปั ะดะปั ะฒัะตั ะพะบััะถะตะฝะธะน

## ะัะดะตะปัะฝัะต ะณะตะฝะตัะฐัะพัั

ะั ัะฐะบะถะต ะผะพะถะตัะต ะทะฐะฟััะบะฐัั ะณะตะฝะตัะฐัะพัั ะฟะพ ะพัะดะตะปัะฝะพััะธ:

```bash
# ะขะพะปัะบะพ security checks ะธ CD workflow
pnpm run infra:generate

# ะขะพะปัะบะพ values ัะฐะนะปั
pnpm run values:generate
```

## ะกัััะบัััะฐ

```
infra/
โโโ generate/
โ   โโโ index.ts          # ะกัะฟะตั-ะณะตะฝะตัะฐัะพั (ัะพัะบะฐ ะฒัะพะดะฐ)
โ   โโโ README.md         # ะญัะฐ ะดะพะบัะผะตะฝัะฐัะธั
โโโ generate-service/
โ   โโโ update-security-checks.ts
โ   โโโ update-cd-workflow.ts
โโโ generate-values/
โ   โโโ generate-values.ts
โ   โโโ defaults.yaml
โ   โโโ environment-overrides.yaml
โ   โโโ templates/
โโโ shared/
โ   โโโ load-services.ts  # ะฃัะธะปะธัะฐ ะดะปั ะทะฐะณััะทะบะธ services.yaml
โโโ services.yaml         # ะะดะธะฝัะน ะธััะพัะฝะธะบ ะฟัะฐะฒะดั ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
```

## ะัะตะธะผััะตััะฒะฐ

- โ ะะดะธะฝะฐั ะบะพะผะฐะฝะดะฐ ะดะปั ะฒัะตั ะณะตะฝะตัะฐัะพัะพะฒ
- โ ะะดะธะฝัะน ะธััะพัะฝะธะบ ะฟัะฐะฒะดั (`services.yaml`)
- โ ะะพัะปะตะดะพะฒะฐัะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ะฒ ะฟัะฐะฒะธะปัะฝะพะผ ะฟะพััะดะบะต
- โ ะะพะดัะพะฑะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะบะฐะถะดะพะณะพ ัะฐะณะฐ
- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะฒัะตั ะบะพะฝัะธะณััะฐัะธะน
- โ ะะพะฝัะธััะตะฝัะฝะพััั ะผะตะถะดั ะฒัะตะผะธ ัะฐัััะผะธ ะธะฝััะฐััััะบัััั

## ะะพะณะดะฐ ะทะฐะฟััะบะฐัั

ะะฐะฟััะบะฐะนัะต ะณะตะฝะตัะฐัะพั ะฟะพัะปะต:
- ะะพะฑะฐะฒะปะตะฝะธั ะฝะพะฒะพะณะพ ัะตัะฒะธัะฐ
- ะะทะผะตะฝะตะฝะธั ะฝะฐัััะพะตะบ ัะตัะฒะธัะฐ ะฒ `service.yaml`
- ะะทะผะตะฝะตะฝะธั ะฑะฐะทะพะฒัั ะทะฝะฐัะตะฝะธะน ะฒ `defaults.yaml`
- ะะทะผะตะฝะตะฝะธั environment overrides

## Troubleshooting

### ะัะธะฑะบะฐ "No services found"

ะฃะฑะตะดะธัะตัั, ััะพ `infra/services.yaml` ัััะตััะฒัะตั ะธ ัะพะดะตัะถะธั ัะพัั ะฑั ะพะดะธะฝ ัะตัะฒะธั.

### ะัะธะฑะบะฐ ะฟัะธ ะพะฑะฝะพะฒะปะตะฝะธะธ workflows

ะัะพะฒะตัััะต, ััะพ ัะฐะนะปั `.github/workflows/security-checks.yml` ะธ `.github/workflows/cd.yml` ัััะตััะฒััั ะธ ะธะผะตัั ะฟัะฐะฒะธะปัะฝัั ััััะบัััั.

### ะัะธะฑะบะฐ ะฟัะธ ะณะตะฝะตัะฐัะธะธ values

ะฃะฑะตะดะธัะตัั, ััะพ ะดะปั ะบะฐะถะดะพะณะพ ัะตัะฒะธัะฐ ัััะตััะฒัะตั ัะฐะนะป `services/${service_name}/service.yaml`.

